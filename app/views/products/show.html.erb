<p id="notice"><%= notice %></p>

<div class="products">
  <div id="all-products">
    <div id="product">
            
    <li> <%= link_to image_tag(@product.image, width: '200', height: '100'), @product %></li>

      <li id="product-name"><%= link_to @product.name, @product %></li>
      <li id="business-name"><%= @product.shop_profile.business_name %></li>
      <li id="style"><%= @product.style.name %></li>
      <li id="description"><%= @product.description %></li>
           <% if @product.quantity > 5 %>
                <li id="quantity">In stock!<li>
                <% elsif @product.quantity <= 0%>
                <li id="quantity">Sold out</li>
                <% else %>
                <li id="quantity">Hurry, kegs running low!</li>
              <% end %>

              <li id="price"><%= number_to_currency(@product.price/100.0) %></li>
              <% if current_user == @product.shop_profile.user %>
                <li id="quantity">Qty: <%= @product.quantity %><li>
                
                <div id="edit-product"><%= link_to 'Edit |', edit_product_path(@product) %>
                 <%= link_to 'Destroy', @product, method: :delete, data: { confirm: 'Are you sure?' } %></div>
       

             <% end %>

          


    <div id="payment">
      <% unless current_user == @product.shop_profile.user %>

        <% if @product.quantity > 0 %>
        <%= form_tag charges_path do %>

          <%= hidden_field_tag(:product_id, @product.id) %>
        <% if user_signed_in? %>
          <%= hidden_field_tag(:user_id, current_user.id) %>
        <% end %>

          <article>
            <% if flash[:error].present? %>
              <div id="error_explanation">
                <p><%= flash[:error] %></p>
              </div>
            <% end %>
          </article>
          
          <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                  
                  data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
                  data-description="<% @product.name %>"
                  data-amount="<%= @product.price %>"
                  data-currency="AUD"
                  data-locale="auto"
                  data-billing-address="true">

                  </script>
          <% end %>
        <% end %>
      <% end %>
      </div>
    </div>
  </div>
</div>
